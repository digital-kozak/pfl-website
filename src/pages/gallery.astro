---
import Layout from '../layouts/Layout.astro';

const galleryImages = [
  {
    src: "/images/006-0278 14317 W US Hwy 160.jpg",
    alt: "Cabin exterior with mountain backdrop",
    category: "Exterior"
  },
  {
    src: "/images/026-Aerial Interior_1.jpg",
    alt: "Great room with stone fireplace",
    category: "Interior"
  },
  {
    src: "/images/036-Aerial Interior_7.jpg",
    alt: "Luxury living space",
    category: "Interior"
  },
  {
    src: "/images/025-Aerial Interior.jpg",
    alt: "Master bedroom suite",
    category: "Bedrooms"
  },
  {
    src: "/images/029-Aerial Interior_2.jpg",
    alt: "Gourmet kitchen",
    category: "Kitchen"
  },
  {
    src: "/images/037-Aerial Interior_8.jpg",
    alt: "Dining area with mountain views",
    category: "Interior"
  },
  {
    src: "/images/007-0279 14317 W US Hwy 160.jpg",
    alt: "Private hot tub",
    category: "Outdoor"
  },
  {
    src: "/images/014-0287 14317 W US Hwy 160.jpg",
    alt: "Cabin deck at sunset",
    category: "Outdoor"
  },
  {
    src: "/images/031-Aerial Interior_3.jpg",
    alt: "Guest bedroom",
    category: "Bedrooms"
  },
  {
    src: "/images/033-Aerial Interior_5.jpg",
    alt: "Living room seating area",
    category: "Interior"
  },
  {
    src: "/images/023-0350 14317 W. US Hwy 160.jpg",
    alt: "Mountain landscape",
    category: "Views"
  },
  {
    src: "/images/008-0280 14317 W US Hwy 160.jpg",
    alt: "Winter mountain view",
    category: "Views"
  }
];

const categories = ["All", "Exterior", "Interior", "Bedrooms", "Kitchen", "Outdoor", "Views"];
---

<Layout title="Gallery | Pagosa Forest Lodge">
  <!-- Hero -->
  <section class="relative py-32 hero-overlay">
    <div class="absolute inset-0 z-0">
      <img 
        src="/images/006-0278 14317 W US Hwy 160.jpg" 
        alt="Gallery hero" 
        class="w-full h-full object-cover"
      />
    </div>
    
    <div class="relative z-10 container-custom text-center text-white">
      <p class="text-sm uppercase tracking-[0.3em] mb-4">Visual Tour</p>
      <h1 class="font-serif text-5xl md:text-7xl">
        <span class="italic">Gallery</span>
      </h1>
    </div>
  </section>

  <!-- Gallery -->
  <section class="section-padding bg-[#faf9f6]">
    <div class="container-custom">
      <div class="text-center max-w-3xl mx-auto mb-12">
        <p class="text-[#c9a227] text-sm uppercase tracking-[0.2em] mb-4">Explore</p>
        <h2 class="font-serif text-4xl md:text-5xl text-[#0f1f0a]"><span class="italic">Photo</span> Gallery</h2>
      </div>

      <!-- Filter Buttons -->
      <div class="flex flex-wrap justify-center gap-3 mb-12">
        {categories.map((category, index) => (
          <button 
            class={`filter-btn px-6 py-2 rounded-full text-sm font-medium transition-all ${index === 0 ? 'bg-[#0f1f0a] text-white' : 'bg-white text-[#0f1f0a] hover:bg-[#0f1f0a] hover:text-white'}`}
            data-category={category}
          >
            {category}
          </button>
        ))}
      </div>

      <!-- Gallery Grid -->
      <div id="gallery-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {galleryImages.map((image, index) => (
          <div 
            class="gallery-item aspect-[4/3] overflow-hidden rounded-lg cursor-pointer group"
            data-category={image.category}
            data-index={index}
          >
            <img 
              src={image.src} 
              alt={image.alt}
              class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
              loading="lazy"
            />
            <div class="absolute inset-0 bg-[#0f1f0a]/0 group-hover:bg-[#0f1f0a]/40 transition-colors duration-300 flex items-center justify-center">
              <div class="opacity-0 group-hover:opacity-100 transition-opacity duration-300 text-white text-center">
                <svg class="w-10 h-10 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"></path>
                </svg>
                <p class="text-sm font-medium">{image.category}</p>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Lightbox -->
  <div id="lightbox" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/95"></div>
    
    <!-- Close Button -->
    <button id="lightbox-close" class="absolute top-4 right-4 z-10 w-12 h-12 flex items-center justify-center text-white/70 hover:text-white transition-colors">
      <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
    
    <!-- Navigation -->
    <button id="lightbox-prev" class="absolute left-4 top-1/2 -translate-y-1/2 z-10 w-12 h-12 flex items-center justify-center text-white/70 hover:text-white transition-colors bg-black/30 rounded-full">
      <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
      </svg>
    </button>
    
    <button id="lightbox-next" class="absolute right-4 top-1/2 -translate-y-1/2 z-10 w-12 h-12 flex items-center justify-center text-white/70 hover:text-white transition-colors bg-black/30 rounded-full">
      <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
      </svg>
    </button>
    
    <!-- Image Container -->
    <div class="relative h-full flex items-center justify-center p-4 md:p-16">
      <img id="lightbox-image" src="" alt="" class="max-w-full max-h-full object-contain">
    </div>
    
    <!-- Caption -->
    <div class="absolute bottom-4 left-0 right-0 text-center">
      <p id="lightbox-caption" class="text-white/90 text-lg"></p>
      <p id="lightbox-counter" class="text-white/50 text-sm mt-2"></p>
    </div>
  </div>

  <script>
    const galleryItems = document.querySelectorAll('.gallery-item');
    const lightbox = document.getElementById('lightbox');
    const lightboxImage = document.getElementById('lightbox-image');
    const lightboxCaption = document.getElementById('lightbox-caption');
    const lightboxCounter = document.getElementById('lightbox-counter');
    const filterBtns = document.querySelectorAll('.filter-btn');
    
    let currentIndex = 0;
    let filteredItems = Array.from(galleryItems);
    
    // Filter functionality
    filterBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const category = btn.dataset.category;
        
        // Update button styles
        filterBtns.forEach(b => {
          b.classList.remove('bg-[#0f1f0a]', 'text-white');
          b.classList.add('bg-white', 'text-[#0f1f0a]');
        });
        btn.classList.remove('bg-white', 'text-[#0f1f0a]');
        btn.classList.add('bg-[#0f1f0a]', 'text-white');
        
        // Filter items
        galleryItems.forEach(item => {
          if (category === 'All' || item.dataset.category === category) {
            item.style.display = 'block';
          } else {
            item.style.display = 'none';
          }
        });
        
        // Update filtered items array
        filteredItems = category === 'All' 
          ? Array.from(galleryItems)
          : Array.from(galleryItems).filter(item => item.dataset.category === category && item.style.display !== 'none');
      });
    });
    
    // Open lightbox
    galleryItems.forEach((item, index) => {
      item.addEventListener('click', () => {
        currentIndex = Array.from(galleryItems).indexOf(item);
        openLightbox(currentIndex);
      });
    });
    
    function openLightbox(index) {
      const item = galleryItems[index];
      const img = item.querySelector('img');
      const category = item.dataset.category;
      
      lightboxImage.src = img.src;
      lightboxCaption.textContent = img.alt;
      lightboxCounter.textContent = `${index + 1} / ${galleryItems.length}`;
      lightbox.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
    
    function closeLightbox() {
      lightbox.classList.add('hidden');
      document.body.style.overflow = '';
    }
    
    function showNext() {
      currentIndex = (currentIndex + 1) % galleryItems.length;
      openLightbox(currentIndex);
    }
    
    function showPrev() {
      currentIndex = (currentIndex - 1 + galleryItems.length) % galleryItems.length;
      openLightbox(currentIndex);
    }
    
    // Event listeners
    document.getElementById('lightbox-close').addEventListener('click', closeLightbox);
    document.getElementById('lightbox-next').addEventListener('click', showNext);
    document.getElementById('lightbox-prev').addEventListener('click', showPrev);
    
    // Close on backdrop click
    lightbox.addEventListener('click', (e) => {
      if (e.target === lightbox || e.target.classList.contains('bg-black/95')) {
        closeLightbox();
      }
    });
    
    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (lightbox.classList.contains('hidden')) return;
      
      if (e.key === 'Escape') closeLightbox();
      if (e.key === 'ArrowRight') showNext();
      if (e.key === 'ArrowLeft') showPrev();
    });
  </script>

  <style>
    .gallery-item {
      position: relative;
    }
  </style>
</Layout>
